# Лабораторная работа №7

## Тема: "***<u>Асинхронное программирование</u>***"

### Цель:

- Знакомство с асинхронным программированием;
- Получение практических навыков в параллельной обработке данных;
- Получение практических навыков в синхронизации потоков;

### Порядок выполнения работы:

- Ознакомиться с теоретическим материалом

- Реализовать задание в соответствии с вариантом (Вариант 22)

- Отчитаться по выполненной работе путём демонстрации работающей программы на тестовых наборах данных (как подготовленных самостоятельно, так и предложенных преподавателем) и ответов на вопросы преподавателя (как из числа контрольных, так и по реализации программы).

### Требования к программе:

Модифицируйте вашу лабораторную работу №6 следующим образом:

- Должно быть реализовано три потока:
  
  - Поток, который осуществляет передвижение NPC на определенное расстояние (см. таблицу), а также определяет, что два NPC находятся на расстоянии убийства (см. таблицу). Если два NPC вступили в «бой», то он создает задачу для потока, осуществляющего бои.
  
  - Поток, который осуществляет бои. Если один npc может убивать другой, то каждый npc «кидает 6-гранный кубик» определяя силу атаки и силу защиты (соответственно). Если сила атаки больше, чем сила защиты – то происходит убийство.
  
  - Мертвые npc не передвигаются (у нас тут без некромантов).
  
  - Живые npc не могут покинуть карту (размер задается через константы, например 100 x 100)
  
  - Основной поток раз в секунду печатает карту. Мертвые npc на карте не отображаются.

- Осуществить контроль доступа к разделяемым ресурсов с помощью std::shared_lock и std::lock_guard

- Осуществить контроль к потоку вывода std::cout через std::lock_guard

- Потоки могут запускаться как std::thread с использованием лямбда функций или функторов (классов с перегруженным оператором operator())

- Вначале игры должно создаваться 50 npc в случайных локациях.

- Игра должна останавливаться через 30 секунд и выводить на экран список выживших

## Условие задачи:

| Кто нагоняет | Расстояние хода | Расстояние убийства |
|:------------:|:---------------:|:-------------------:|
| Дракон       | 50              | 30                  |
| Бык          | 30              | 10                  |
| Жаба         | 1               | 10                  |

---

## Структура проекта

```
tasks/lab7/
├── CMakeLists.txt
├── main.cpp
├── include/
│ ├── BattleVisitor.h
│ ├── GameWorld.h
│ ├── NPCTypes.h
│ ├── Point.h
│ ├── NPC.h
│ ├── NPCFactory.h
│ └── Observer.h
│
├── src/
│ ├── BattleVisitor.cpp
│ ├── GameWorld.cpp
│ ├── NPCTypes.cpp
│ ├── NPC.cpp
│ ├── NPCFactory.cpp
│ └── Observer.cpp
│
└── tests/
├── test_lab07.cpp
```
```

## Сборка и запуск проекта

**Сборка:**

```bash
mkdir build
cd build

# Конфигурация проекта
cmake ..

# Сборка
make

```

**Запуск программы:**

```bash
# Из директории build/tasks/lab7
./lab07_demo
```

**Запуск тестов:**

```bash
# Из директории build/tasks/lab7

./lab07_tests
```
